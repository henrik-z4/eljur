# Электронный журнал успеваемости — "Учет успеваемости студентов" MVP

- Исполнители: Мурадян Г.О., Рубаник В.А.

## Основная идея проекта

Простой, но масштабируемый электронный журнал для учета успеваемости:
- преподаватели вводят и корректируют оценки;
- система считает средний балл и итоговую оценку автоматически;
- данные хранятся в локальной базе (электронный журнал); 
- студенты видят свои результаты в личном кабинете;
- учебная часть формирует отчёты по группам/курсам/предметам;
- авторизация (логин/пароль) — роли: `admin`, `teacher`, `student`.

Ни одного лишнего экрана. Реализуем всё парой-тройкой страниц и API-эндпоинтами.

---

## Стек

- Next.js (React + SSR) — TypeScript
- Prisma ORM + SQLite (файл) — быстрый запуск без конфигураций
- Tailwind CSS — красивый UI
- JWT + bcrypt — простая и надёжная авторизация
- Vercel/Docker — для деплоя

Почему так: Next.js + Prisma + SQLite дают супербыстрый MVP, а TypeScript — аккуратность. Tailwind + готовые компоненты — красиво и быстро.

---

## Что сделано / требования TASK.md

1. Преподаватели вводят и корректируют оценки (Форма: форма ввода оценок, ведомость).
2. Поддержка автоматического расчёта среднего балла и итоговой оценки (алгоритм ниже).
3. Хранение всех данных в электронном журнале (Prisma + SQLite).
4. Студенты могут просматривать свои результаты в личном кабинете.
5. Учебная часть формирует отчёты по группам, курсам и предметам (страница "Отчёты").
6. Авторизация пользователей (логин/пароль) — роли: `teacher`, `admin`, `student`.

Дополнительно: список форм, упомянутых в `TASK.md` реализуется как страницы/модали (в простом и аккуратном виде).

---

## Быстрое руководство — Как запустить (2 минуты)

Установка и запуск локально (macOS, zsh):

```bash
# 1) Клонируешь проект
git clone <repo> && cd eljur

# 2) Устанавливаешь зависимости
npm install

# 3) Настраиваешь prisma и запускаешь миграцию (sqlite):
npx prisma generate
npx prisma migrate dev --name init --preview-feature

# 4) Сидирование базы (создание админ/teacher/student пользователей)
npm run seed

# 5) Запуск dev-сервера
npm run dev

# 6) Открываешь UI в браузере
# http://localhost:3000
```

Примеры логинов (seed, можно поменять):
- `admin@eljur.local` / `AdminPass123` (админ)
- `teacher@eljur.local` / `TeacherPass123` (преподаватель)
- `student@eljur.local` / `StudentPass123` (студент)

---

## Быстрая архитектура и минимальные сущности (Prisma schema)

Пример упрощённой схемы (для быстрого выполнения MVP):

- User { id, email, passwordHash, name, role }
- Student { id, userId, groupId }
- Teacher { id, userId }
- Group { id, name, course }
- Subject { id, name }
- Enrollment { id, studentId, subjectId }  // или связка
- Grade { id, studentId, subjectId, score, date, type }

Вместо отдельной сущности Journal — журнал формируется агрегированием `Grade` по `Student/Subject`.

---

## Алгоритм подсчёта среднего и итоговой оценки

- Средний балл (avg) = среднее арифметическое всех оценок студента по дисциплине (брать только оценки с типом `exam`/`test`/`homework` если захотим уточнить — но базово: все оценки).
- Итоговая оценка (final) — в формате 2..5 (российская шкала) по следующей простой формуле:
  - avg >= 4.5 -> 5
  - avg >= 3.5 -> 4
  - avg >= 2.5 -> 3
  - otherwise -> 2

Изменить формулу легко; важно, что расчёт идёт автоматически при каждом добавлении/изменении оценки.

---

## Страницы (UI) и формы (соответствие TASK.md)

1. `/login` — форма авторизации (для всех пользователей).
2. `/teacher/grades` — форма ввода/редактирования оценок (для преподавателя): таблица группы -> выставление оценок -> авто calc.
3. `/student/profile` — просмотр оценок, средний/итоговый балл (личный кабинет).
4. `/teacher/journal` — ведомость по дисциплине с возможностью выгрузки CSV.
5. `/reports` — отчет по группам/курсам/предметам (для учебной части).
6. `/admin/users` — управление пользователями (для администратора).
7. `/journal` — общий электронный журнал (форма/компонент с фильтрами).

---

## API (минимум для MVP)

Endpoints:

- POST `/api/auth/login` — логин, возвращает JWT.
- POST `/api/auth/register` — если нужно (админ/seed).
- GET `/api/students/:id/grades` — получить оценки студента
- POST `/api/grades` — создать оценку (teacher)
- PUT `/api/grades/:id` — обновить оценку (teacher)
- GET `/api/reports?group=x&subject=y` — получить отчет
- GET `/api/groups` / `/api/subjects` / `/api/users` — вспомогательные

Все API проверяют роль по JWT; только `teacher` может редактировать, `student` только читать свои данные, `admin` — управлять пользователями.

---

## План реализации

1. Инициализация проекта: Next.js + TypeScript + Tailwind + Prisma + SQLite.
2. Определить Prisma schema и миграции + `seed` script.
3. Реализовать аутентификацию JWT + простой layout + login page.
4. Реализовать CRUD для `Grade` (teacher) и страницу просмотра студентом.
5. Реализовать отчеты и экспорт CSV.
6. Покрытие: тестовые данные, README, демонстрация.

Затем: показать работу (презентация — 5–10 минут: как пользоваться).

---

## Структура проекта

```
/ (root)
├─ /app or /pages
│  ├─ /api
│  │  ├─ auth.ts
│  │  ├─ grades.ts
│  │  └─ reports.ts
│  ├─ /teacher
│  ├─ /student
│  └─ /admin
├─ /prisma
│  └─ schema.prisma
├─ /components
├─ /lib (prisma client, auth helpers)
├─ /scripts (seed.js)
└─ README.md
```

---

## Сценарии тестирования

1. Логин под преподавателем, выставление оценки — увидеть, как средний и итоговый обновляются.
2. Логин под студентом — проверить, что студент видит только свои оценки и общий журнал/статистику.
3. Логин под учебной частью (admin) — сгенерировать отчет по группе/курсу/предмету и выгрузить CSV.

---

## Seed-скрипт (пример логики — в проекте)

- Создаём 1 администратора, 2 преподавателя, 6 студентов, 2-3 предмета, группы, несколько оценок для видимости UI.

---